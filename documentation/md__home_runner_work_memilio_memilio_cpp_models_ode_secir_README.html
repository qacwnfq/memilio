<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MEmilio: ODE-based SECIR-type model</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">MEmilio
   &#160;<span id="projectnumber">0.7</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">ODE-based SECIR-type model </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>This module models and simulates the epidemic using an ODE-based SECIR-type model approach. Unlike the agent based model that uses particular agents, this model simulates the spread of a communicable disease in a population with subpopulations being in different compartments such as <code>Exposed</code>, <code>InfectedNoSymptoms</code>, <code>InfectedSymptoms</code> or <code>Recovered</code>. Individuals with and without symptoms are supposed to be infectious.</p>
<h1><a class="anchor" id="autotoc_md47"></a>
Structure</h1>
<p>The model consists of the following major classes:</p><ol type="1">
<li>Populations: Generic class to create groups and/or compartments, i.e., subpopulations of a total population, using multiple dimensions. Dimensions can be age, infection state, income, gender, etc.</li>
<li>Uncertain Matrix: Implements uncertain contact patterns between different (age) groups, one representation being a ContactMatrix(Group). This matrix contains contact patterns between different groups and <code>Dampings</code> that model a change in contact patterns by a multiplicative factor at a given day.</li>
<li>Dampings: A <code>Damping</code> object is the combination of a particular day and a multiplicative factor that changes the contact patterns. Dampings can be overwritten by or combined with dampings at later times. In order to not create discontinuities in pattern changes, the transition is smoothed by a cosine S-type function on an interval of maximum length of one day. The resulting contact rate satisfies C^1-smoothness between two consecutive dampings.</li>
<li>SECIR: implements an <em>age-resolved ODE-model</em>, based on the non-age-resolved based model as described in <a href="https://www.medrxiv.org/content/10.1101/2020.04.04.20053637v1">https://www.medrxiv.org/content/10.1101/2020.04.04.20053637v1</a>, uses the compartments <code>Susceptible (S)</code>, <code>Exposed (E)</code>, <code>InfectedNoSymptoms (I_NS)</code>, <code>InfectedSymptoms (I_Sy)</code>, <code>InfectedSevere (I_Sev)</code>, <code>InfectedCritical (I_Cr)</code>, <code>Recovered (R)</code> and <code>Dead</code>. The final model has been published in <a href="https://doi.org/10.1016/j.mbs.2021.108648">https://doi.org/10.1016/j.mbs.2021.108648</a>. <code>Exposed</code> individuals are not infectious and it is assumed that subsequent infections can occur at random during the infectious period before the onset of symptoms, i.e., from state <code>InfectedNoSymptoms (I_NS)</code>. Recovered people remain immune. Severely or critically infected individuals are assumed to be isolated. The <code>Model</code> Uses <code>Populations</code> to model different 'groups' of a particular age-range (first dimension) and an <code>InfectionState</code> (second dimension). Parameters are set as <code>Parameters</code>; they contain contact patterns in form of an <code>UncertainContactMatrix</code> and an extended set of pathogen-dependent parameters.</li>
<li>Parameter Space: Factory class for the 'Parameters' to set distributions to the different parameters and providing the opportunity to sample from these parameter set containing random distributions.</li>
<li>Parameter Studies: Method to be called on a set of 'Parameters' with a given set of random distributions to sample from the distributions and run ensemble simulations with the obtained samples.</li>
</ol>
<p>Below is an overview of the model architecture and its compartments.</p>
<p><img src="https://github.com/SciCompMod/memilio/assets/70579874/46b09e8a-d083-4ef9-8328-21975890b60f" alt="secir_model" class="inline"/> </p><table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Mathematical variable   </th><th class="markdownTableHeadNone">C++ variable name   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">$\phi$   </td><td class="markdownTableBodyNone"><code>ContactPatterns</code>   </td><td class="markdownTableBodyNone">Matrix of daily contact rates / number of daily contacts between different age groups.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">$\rho$   </td><td class="markdownTableBodyNone"><code>TransmissionProbabilityOnContact</code>   </td><td class="markdownTableBodyNone">Transmission risk for people located in one of the susceptible compartments.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">$\xi_{I_{NS}}$   </td><td class="markdownTableBodyNone"><code>RelativeTransmissionNoSymptoms</code>   </td><td class="markdownTableBodyNone">Proportion of nonsymptomatically infected people who are not isolated.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">$\xi_{I_{Sy}}$   </td><td class="markdownTableBodyNone"><code>riskFromInfectedSymptomatic</code>   </td><td class="markdownTableBodyNone">Proportion of infected people with symptomps who are not isolated (time-dependent if <code>TestAndTraceCapacity</code> used).    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">$N_j$   </td><td class="markdownTableBodyNone"><code>Nj</code>   </td><td class="markdownTableBodyNone">Total population of age group $j$.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">$D_i$   </td><td class="markdownTableBodyNone"><code>Di</code>   </td><td class="markdownTableBodyNone">Number of death people of age group $i$.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">$T_{E}$   </td><td class="markdownTableBodyNone"><code>TimeExposed</code>   </td><td class="markdownTableBodyNone">Time in days an individual stays in the Exposed compartment.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">$T_{I_{NS}}$   </td><td class="markdownTableBodyNone"><code>TimeInfectedNoSymptoms</code>   </td><td class="markdownTableBodyNone">Time in days an individual stays in the InfectedNoSymptoms compartment.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">$T_{I_{Sy}}$   </td><td class="markdownTableBodyNone"><code>TimeInfectedSymptoms</code>   </td><td class="markdownTableBodyNone">Time in days an individual stays in the InfectedSymptoms compartment.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">$T_{I_{Sev}}$   </td><td class="markdownTableBodyNone"><code>TimeInfectedSevere</code>   </td><td class="markdownTableBodyNone">Time in days an individual stays in the InfectedSevere compartment.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">$T_{I_{Cr}}$   </td><td class="markdownTableBodyNone"><code>TimeInfectedCritical</code>   </td><td class="markdownTableBodyNone">Time in days an individual stays in the InfectedCritical compartment.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">$\mu_{I_{NS}}^{I_{Sy}}$   </td><td class="markdownTableBodyNone"><code>1 - RecoveredPerInfectedNoSymptoms</code>   </td><td class="markdownTableBodyNone">Probability of transition from compartment InfectedNoSymptoms to InfectedSymptoms.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">$\mu_{I_{Sy}}^{I_{Sev}}$   </td><td class="markdownTableBodyNone"><code>SeverePerInfectedSymptoms</code>   </td><td class="markdownTableBodyNone">Probability of transition from compartment InfectedSymptoms to InfectedSevere.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">$\mu_{I_{Sev}}^{I_{Cr}}$   </td><td class="markdownTableBodyNone"><code>CriticalPerSevere</code>   </td><td class="markdownTableBodyNone">Probability of transition from compartment InfectedSevere to InfectedCritical.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">$\mu_{I_{Cr}}^{D}$   </td><td class="markdownTableBodyNone"><code>DeathsPerCritical</code>   </td><td class="markdownTableBodyNone">Probability of dying when in compartment InfectedCritical.   </td></tr>
</table>
<h1><a class="anchor" id="autotoc_md48"></a>
Simulation</h1>
<p>The simulation runs in discrete time steps using a numerical integration scheme. At each time step, a part of the population of each age-aware compartment moves from the current compartment to a new one. Different numerical integrations schemes are available, see the <code>math</code> folder. The Simulation class handles the parameters and the numerical integrator. It also stores the result. Ensemble runs can be done using the Parameter Studies class as soon as random distributions are set for all the parameters. This can be done using the Parameter Space class.</p>
<h1><a class="anchor" id="autotoc_md49"></a>
Examples</h1>
<p>Different examples can be found at:</p>
<ul>
<li>examples/ode_secir.cpp</li>
<li>examples/ode_secir_ageres.cpp</li>
<li>examples/ode_secir_parameter_study.cpp </li>
</ul>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
